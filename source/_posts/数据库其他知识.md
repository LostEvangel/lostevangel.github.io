---

title: 数据库其他知识
date: 2019-3-24 14:20:01
tags: [面试,数据库]
categories: [面试,数据库]

---

# 数据库其他知识

---

## 其他知识

### delete truncate drop区别

区别 | delete | truncate | drop
---|--- | --- | ---
类型回滚 | 可回滚 | 不可回滚 | 不可回滚
删除内容 | 表结构还在，删除表全部或部分内容 | 表结构还在，删除全部内容 | 删除表，所有数据、索引、权限一并删除
删除速度 | 逐行删除，速度慢 | 速度快 | 速度快

### 存储过程
预编译的sql语句，一次创建，多次使用。
#### 优点
1. 预编译，效率高。
2. 存放在数据库，减少网络传输。
3. 安全性高，需要一定权限。
4. 一次创建可多次使用，提高开发效率。

### 视图
从一个表或多个表导出的表，是虚表，不存具体数据。

### 主从复制
将主数据库的DDL、DML操作记录到二进制文件（BINLOG），传输到从数据库，从数据库重新执行，使得从数据库数据和主数据库保持一致。

#### 主从复制作用
- 主数据库故障可以切换到从数据库；
- 可以读写分离；
- 从数据库可以日志备份。

#### 复制过程
1. 主数据库更新数据完成前，将操作记录顺序记录到BINLOG；
2. 从数据库开启一个I/O线程，该线程在主数据库打开一个普通连接，将读到的事件写入到中继日志，如果读取的进度跟上了master，就进入睡眠等待；
3. 从数据库的SQL线程将读取中继日志，并顺序执行操作。

### 大表数据查询的优化
1. 优化Schema，sql语句、索引。
2. 加缓存，memcached，redis
3. 主从复制，读写分离
4. 垂直拆分，分布式系统
5. 水平切分，要选择合适的sharding key，为了好的查询效率，表结构也要改变，应用也需要改变，sql中尽量带sharding key，将数据定位到限定的表去查，而不是全部的表。



---

参考文献：https://www.weiweiblog.cn/databases/