---
title: 计算机网络知识总结
date: 2019-03-26 12:19:17
tags: [面试]
categories: [面试]
description: 面试中可能会问到的计算机网络知识
---

# 计算机网络面试知识总结

## OSI、TCP/IP、五层协议的体系结构

![architecture.png](/image/interview_prep/architecture.png)

### OSI七层结构

- 物理层：通过媒介传输比特，确定机械及电气规范（Bit）
- 数据链路层：将比特组装成帧和点到点的传输（帧Frame）
- 网络层：负责数据包从源到宿的传输和网际互联（数据包Packet）
- 传输层：提供端对端的可靠报文传输和错误恢复（段Segment）
- 会话层：建立、管理、终止会话。（会话协议数据单元SPDU）
- 表示层：对数据翻译，加密，压缩。（表示协议数据单元PPDU）
- 应用层：允许访问OSI环境的手段。（应用协议数据单元APDU）

### TCP/IP四层结构

- 数据链路层（网络接口层/从主机到网络层）：模型没有真正描述这一层实现，只是为上一层提供接口。
- 网络层：处理和分组相关，协议主要包括：IP协议（网际协议）、ICMP协议（Internet网络控制报文协议）、IGMP协议（Internet组管理协议）。
- 传输层：为两台主机应用提供端对端的通信。TCP、UDP。
- 应用层：负责处理特殊应用程序细节。Telnet、FTP、SMTP、SNMP（简单网络管理协议）

IP层提供不可靠的服务。TCP提供可靠的服务。为了提供可靠服务，TCP采用超时重传、发送和接收端到端的确认分组机制。

## 常用端口和对应服务


端口 | 服务
:-:|:-:
21 | FTP
22 | SSH
23 | TELNET
25 | SMTP
53 | DNS
80 | HTTP
110 | POP3
443 | HTTPS
1080 |SOCKETS
3306 | MYSQL

## TCP三次握手 四次挥手

**三次握手：**

```
sequenceDiagram
Client->>Server: SYN seq = x
Server->>Client: SYN seq = y, ACK = x+1
Client->>Server: ACK = y+1
```
第一次握手：建立连接，客户端发送连接请求报文段，将SYN位置为1，sequence number为x，然后进入SYN_SEND状态，等待服务端。

第二次握手：服务器接收到请求，对SYN报文段进行确认，设置acknowledge number设置为x+1，将SYN置为1，sequence number为y，将所有信息放入一个报文段中，发送给客户端，进入SYN_RECV状态。

第三次握手：客户端接收到报文段，将acknowledge number置为y+1，向服务端发送ACK报文段，发送完毕后，进入ESTABLISHED状态。

**四次挥手：**
```
sequenceDiagram
Client->>Server: FIN seq = x+2, ACK = y+1
Server->>Client: ACK = x+3
Server->>Client: FIN seq = y+1
Client->>Server: ACK = y+2
```
第一次挥手：客户端发送FIN请求关闭。
第二次挥手：服务端接收到FIN，回复ACK，序号为收到的+1。
第三次挥手：服务端发送一个FIN，关闭服务端到客户端的传输。
第四次挥手：客户端收到FIN，回复ACK，序号为收到的+1。


## IP地址


类别 | 网络号| 地址范围|网络号|主机号|私有地址
:-:|:-:|:-:|:-:|:-:|:-:|
A类 | 以0开头| 1.0.0.0 – 127.255.255.255| 8位| 24位| 10.0.0.0 - 10.255.255.255
B类 | 以10开头| 128.0.0.0 – 191.255.255.255| 16位| 16位| 172.16.0.0 - 172.31.255.255
C类 | 以110开头| 192.0.0.0 – 223.255.255.255| 24位| 8位| 192.168.0.0 - 192.168.255.255

## TCP/UDP区别

### TCP

- 优点：可靠，稳定。需要三次握手才能建立接连。传输时有重传、确认、窗口、拥塞控制。
- 缺点：慢，效率低。各种机制消耗时间、占用资源。

### UDP：
- 优点：快，比TCP稍安全。
- 缺点：不可靠，不稳定。网络不好会丢包。

### 区别


区别 | TCP | UDP
---|:--:|:-:
连接 | 面向连接| 面向无连接
可靠性 | 可靠，无丢失，无差错，不重复 | 不保证可靠性交付
模式 | 流模式（字节流） | 数据报模式（报文）
连接 | 点到点| 支持一对一，一对多，多对一，多对多
首部开销| 20字节| 8字节
逻辑通信信道| 全双工的可靠信道| 不可靠信道
速度 | 慢 | 快
对系统资源要求 | 较多 | 较少


## ARP协议
1. 首先，每个主机会在自己的ARP缓冲区建立一个ARP列表，保存IP和MAC的对应关系。
2. 当源主机要发送数据时，现在自己的ARP列表是否要对应的IP地址，如果有，直接发送，如果没有，会在网段内所有主机发送数据包，包括：源主机IP，源主机MAC地址，目的主机IP。
3. 当本网段所有主机接收到数据包时，先检查数据包中的目的主机是否是自己的IP，如果不是，忽略；如果是，更新自己ARP，将源主机IP和MAC写入，并将自己的MAC地址写入响应包。
4. 源主机接收到相应包，将目的主机MAC和IP写入ARP列表，然后以此通信。如果一直没有响应包，则ARP查询失败。

## 从输入网址到获得页面的过程

1. DNS查询，查找域名对应的IP地址。这一步会依次查找浏览器缓存，系统缓存，路由器缓存，ISPNDS缓存，根域名服务器。
2. 浏览器获得域名对应的IP地址以后，浏览器向服务器请求建立链接，发起三次握手；
3. TCP/IP链接建立起来后，浏览器向服务器发送HTTP请求；
4. 服务器接收到这个请求，并根据路径参数映射到特定的请求处理器进行处理，并将处理结果及相应的视图返回给浏览器；
5. 浏览器解析并渲染视图，若遇到对js文件、css文件及图片等静态资源的引用，则重复上述步骤并向服务器请求这些资源；
6. 浏览器根据其请求到的资源、数据渲染页面，最终向用户呈现一个完整的页面。

## Session 与 Cookie

- 实现机制：Session的实现常常依赖于Cookie机制，通过Cookie机制回传SessionID
- 大小限制：Cookie有大小限制并且浏览器对每个站点也有cookie的个数限制，Session没有大小限制，理论上只与服务器的内存大小有关
- 安全性：Cookie存在安全隐患，通过拦截或本地文件找得到cookie后可以进行攻击，而Session由于保存在服务器端，相对更加安全；
- 服务器资源消耗：Session是保存在服务器端上会存在一段时间才会消失，如果session过多会增加服务器的压力。
- Application（ServletContext）：与一个Web应用程序相对应，为应用程序提供了一个全局的状态，所有客户都可以使用该状态。


## Http和Https的区别
Http协议运行在TCP之上，明文传输，客户端与服务器端都无法验证对方的身份；Https是身披SSL(Secure Socket Layer)外壳的Http，运行于SSL上，SSL运行于TCP之上，是添加了加密和认证机制的HTTP。二者之间存在如下不同：
- 端口不同：Http与Http使用不同的连接方式，用的端口也不一样，前者是80，后者是443；
- 资源消耗：和HTTP通信相比，Https通信会由于加减密处理消耗更多的CPU和内存资源；
- 开销：Https通信需要证书，而证书一般需要向认证机构购买；

## Get与POST的区别

- 功能：GET用于获取资源，POST修改资源。
- REST服务：GET是幂等的，即读取同一个资源，总是得到相同的数据，而POST不是幂等的，因为每次请求对资源的改变并不是相同的；进一步地，GET不会改变服务器上的资源，而POST会对服务器资源进行改变；
- 请求参数形式：GET放在HTTP报文请求头中，POST放在请求体中。
- 安全性：POST安全性高。
- 请求大小：GET的URL长度有限，POST没有大小限制。